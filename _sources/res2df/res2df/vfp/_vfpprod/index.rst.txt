res2df.vfp._vfpprod
===================

.. py:module:: res2df.vfp._vfpprod

.. autoapi-nested-parse::

   Utilities to extract the VFPPROD data from an Eclipse (input) deck.
   Data can be extracted from Eclipse (.Ecl format) in 3 different formats:
   basic_data (dictionary with basic data types), df (pandas DataFrame) or
   pyarrow_tables (pyarrow.Tables).

   Data can be extracted from a complete deck or from individual files.
   Supports output both in csv format as a pandas DataFrame or in pyarrow
   as pyarrow.Table. Also functionality to write pandas DataFrame and
   pyarrow.Table to file as Eclipse .Ecl format.



Functions
---------

.. autoapisummary::

   res2df.vfp._vfpprod._deckrecord2list
   res2df.vfp._vfpprod._stack_vfptable2df
   res2df.vfp._vfpprod._string2intlist
   res2df.vfp._vfpprod._write_vfp_range
   res2df.vfp._vfpprod.basic_data
   res2df.vfp._vfpprod.basic_data2df
   res2df.vfp._vfpprod.basic_data2pyarrow
   res2df.vfp._vfpprod.df2basic_data
   res2df.vfp._vfpprod.pyarrow2basic_data
   res2df.vfp._vfpprod._check_basic_data
   res2df.vfp._vfpprod.df
   res2df.vfp._vfpprod.pyarrow
   res2df.vfp._vfpprod._write_basic_record
   res2df.vfp._vfpprod._write_table_records
   res2df.vfp._vfpprod.df2res


Module Contents
---------------

.. py:function:: _deckrecord2list(record: opm.opmcommon_python.DeckRecord, keyword: str, recordindex: int, recordname: str) -> list[float]

   Parse an opm.opmcommon_python.DeckRecord belonging to a certain keyword
   and return as list of numbers

   :param record: Record be parsed
   :param keyword: Which keyword this belongs to
   :param recordindex: For keywords where itemlistname is 'records', this is a
                       list index to the "record".
   :param recordname: Name of the record


.. py:function:: _stack_vfptable2df(index_names_list: list[str], index_values_list: numpy.ndarray | list[list[float]], flow_values_list: numpy.ndarray | list[float], table_values_list: numpy.ndarray | list[list[float]]) -> pandas.DataFrame

   Return a dataframe from a list of interpolation ranges and tabulated values

   :param index_names_list: List with name of each interpolated
                            quantity (i.e. THP, WFR, GFR, ALQ for VFPPROD
                            or THP for VFPINJ)
   :param index_values_list: List of list with values for
                             each interpolated quantity for
                             each row in vfp table (each record)
                             (dim (no index names) x (no records))
   :param flow_values_list: List of flow values (dim = no flow_values)
   :param table_values_list: List of list with tabulated values
                             (dim = (no records) x  (no flow_values))


.. py:function:: _string2intlist(list_def_str: str) -> _string2intlist.list[int]

   Produce a list of int from input string

   :param list_def_str: String defining list of int
                        Format "[1,2,6:9]" to define list [1,2,6,7,8,9]


.. py:function:: _write_vfp_range(values: list[float], var_type: str, unit_type: str, format: str = '%10.6g', values_per_line: int = 5) -> str

   Creates a :term:`include file` content string of a resdata
   record for a given table range

   :param values: List/array with the range sorted
   :param var_type: The Eclipse variable type defintion
   :param unit_type: The unit type for the variable
   :param format: Format string for values
   :param values_per_line: Number of values per line in output


.. py:function:: basic_data(keyword: opm.opmcommon_python.DeckKeyword, vfpnumbers_str: str | None = None) -> dict[str, Any] | None

   Read and return all data for Eclipse VFPPROD keyword as basic data types

   Empty string returned if vfp table number does not match any number in list

   :param keyword: :term:`.DATA file` keyword
   :param vfpnumbers_str: String with list of vfp table numbers to extract.
                          Syntax "[0,1,8:11]" corresponds


.. py:function:: basic_data2df(tableno: int, datum: float, rate_type: res2df.vfp._vfpdefs.VFPPROD_FLO, wfr_type: res2df.vfp._vfpdefs.WFR, gfr_type: res2df.vfp._vfpdefs.GFR, alq_type: res2df.vfp._vfpdefs.ALQ, thp_type: res2df.vfp._vfpdefs.THPTYPE, unit_type: res2df.vfp._vfpdefs.UNITTYPE, tab_type: res2df.vfp._vfpdefs.VFPPROD_TABTYPE, flow_values: numpy.ndarray, thp_values: numpy.ndarray, wfr_values: numpy.ndarray, gfr_values: numpy.ndarray, alq_values: numpy.ndarray, thp_indices: numpy.ndarray, wfr_indices: numpy.ndarray, gfr_indices: numpy.ndarray, alq_indices: numpy.ndarray, tab_data: numpy.ndarray) -> pandas.DataFrame

   Return a pandas DataFrame from VFPPROD liftcurve data

   :param tableno: table number
   :param datum: datum depth
   :param rate_type: rate type used for flow values
   :param wfr_type: water fraction type
   :param gfr_type: gas fraction type
   :param alq_type: artificial lift type
   :param thp_type: thp type
   :param unit_type: unit type
   :param tab_type: type for tabulated (record) values
   :param flow_values: rate values used to generate table
   :param thp_values: THP values used to generate table
   :param wfr_values: water fraction values used to generate table
   :param gfr_values: gas fraction values used to generate table
   :param alq_values: artificial lift values (if any) used to generate table
   :param thp_indices: which index in thp value table a given BHP value
                       corresponds to (1-base)
   :param wfr_indices: which index in wfr value table a given BHP value
                       corresponds to (1-base)
   :param gfr_indices: which index in gfr value table a given BHP value
                       corresponds to (1-base)
   :param alq_indices: which index in alq value table a given BHP value
                       corresponds to (1-base)
   :param tab_data: tabulated (BHP) data
                    (ordered as thp-, wfr-, gfr-, alq- and flow-values)


.. py:function:: basic_data2pyarrow(tableno: int, datum: float, rate_type: res2df.vfp._vfpdefs.VFPPROD_FLO, wfr_type: res2df.vfp._vfpdefs.WFR, gfr_type: res2df.vfp._vfpdefs.GFR, alq_type: res2df.vfp._vfpdefs.ALQ, thp_type: res2df.vfp._vfpdefs.THPTYPE, unit_type: res2df.vfp._vfpdefs.UNITTYPE, tab_type: res2df.vfp._vfpdefs.VFPPROD_TABTYPE, flow_values: numpy.ndarray, thp_values: numpy.ndarray, wfr_values: numpy.ndarray, gfr_values: numpy.ndarray, alq_values: numpy.ndarray, thp_indices: numpy.ndarray, wfr_indices: numpy.ndarray, gfr_indices: numpy.ndarray, alq_indices: numpy.ndarray, tab_data: numpy.ndarray) -> pyarrow.Table

   Return a pyarrow Table from VFPPROD liftcurve data

   :param tableno: table number
   :param datum: datum depth
   :param rate_type: rate type used for flow values
   :param wfr_type: water fraction type
   :param gfr_type: gas fraction type
   :param alq_type: artificial lift type
   :param thp_type: thp type
   :param unit_type: unit type
   :param tab_type: type for tabulated (record) values
   :param flow_values: rate values used to generate table
   :param thp_values: THP values used to generate table
   :param wfr_values: water fraction values used to generate table
   :param gfr_values: gas fraction values used to generate table
   :param alq_values: artificial lift values (if any) used to generate table
   :param thp_indices: THP indices for each record in tabulated data
   :param wfr_indices: WFR indices for each record in tabulated data
   :param gfr_indices: GFR indices for each record in tabulated data
   :param alq_indices: ALQ indices for each record in tabulated data
   :param tab_data: tabulated (BHP) data
                    (ordered according to thp-, wfr-, gfr-, alq- and flow-values)


.. py:function:: df2basic_data(dframe: pandas.DataFrame) -> dict[str, Any]

   Return basic data type for VFPPROD from a pandas dataframe.

   Return format is a dictionary all data in VFPPROD in basic data types
   (str, int, float, numpy.array)

   :param dframe: pandas DataFrame for VFPPROD


.. py:function:: pyarrow2basic_data(pa_table: pyarrow.Table) -> dict[str, Any]

   Return basic data type for VFPPROD from a pyarrow.Table.

   Return format is a dictionary all data in VFPPROD in basic data types
   (str, int, float, numpy.array)

   :param pa_table: pyarrow Table with data for VFPPROD


.. py:function:: _check_basic_data(vfp_data: dict[str, Any]) -> bool

   Perform a check of the VFPPROD data contained in the dictionary.
   Checks if all data is present and if the dimensions of the arrays
   are consistent.

   :param vfp_data: Dictionary containing all data for a VFPPROD keyword in Eclipse


.. py:function:: df(keyword: opm.opmcommon_python.DeckKeyword, vfpnumbers_str: str | None = None) -> pandas.DataFrame | None

   Return a dataframe or pyarrow Table of a single VFPPROD table
   from a :term:`.DATA file`.

   :param keyword: :term:`.DATA file` keyword
   :param vfpnumbers_str: String with list of vfp table numbers to extract.
                          Syntax "[0,1,8:11]" corresponds to [0,1,8,9,10,11].


.. py:function:: pyarrow(keyword: opm.opmcommon_python.DeckKeyword, vfpnumbers_str: str | None = None) -> pyarrow.Table | None

   Return a pyarrow Table of a single VFPPROD table from a :term:`.DATA file`.
      If no VFPPROD curve found, return None

   :param keyword: :term:`.DATA file` keyword
   :param vfpnumbers_str: String with list of vfp table numbers to extract.
                          Syntax "[0,1,8:11]" corresponds to [0,1,8,9,10,11].


.. py:function:: _write_basic_record(tableno: int, datum: float, flo_type: str, wfr_type: str, gfr_type: str, alq_type: str, pressure_type: str, unit_type: str, tab_type: str) -> str

   Creates a :term:`include file` content string representing
   the first record for Eclipse VFPPROD keyword

   :param tableno: VFPROD table number
   :param datum: datum depth
   :param flo_type: FLO type
   :param wfr_type       WFR type:
   :param gfr_type       GFR type:
   :param alq_type: ALQ type
   :param pressure_type: THP type
   :param unit_type: Unit type
   :param tab_type: Table type (BHP/THT)


.. py:function:: _write_table_records(thp_indices: numpy.ndarray, wfr_indices: numpy.ndarray, gfr_indices: numpy.ndarray, alq_indices: numpy.ndarray, table: numpy.ndarray, format: str = '%10.6g', values_per_line: int = 5) -> str

   Creates a :term:`include file` content string representing a
   resdata record for a VFPPROD table (BHP part)

   :param thp_indices: array of int representing index for THP value for record
   :param wfr_indices: array of int representing index for WFR value for record
   :param gfr_indices: array of int representing index for GFR value for record
   :param alq_indices: array of int representing index for ALQ value for record
   :param table: DataFrame with multiindex for table ranges and colums
                 for tabulated values (BHP)
   :param format: Format string for values
   :param values_per_line: Number of values per line in output


.. py:function:: df2res(dframe: pandas.DataFrame, comment: str | None = None) -> str

   Creates a :term:`include file` content string
   representing single VFPPROD Eclipse input from a dataframe

   All data for the keywords VFPPROD will be returned.

   :param dframe: Dataframe containing complete description of single VFPPROD input
   :param comment: Text that will be included as comment


